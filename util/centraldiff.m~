function v = centraldiff(x, fs)
%  v = centraldiff(x, fs)
%  Computes velocity estimates as the central difference of x.
%  Operates along the columns of x. v has the same size as x. 
%  The first and last elements are estimated by the one-step ahead
%  and one-step back approximation. fs is the sampling frequency.
%

% Kjartan Halvorsen
% 2004-03-23
  
xplus1 = x(3:end,:);
xmin1 = x(1:end-2,:);

v = cat(1, (x(2,:) - x(1,:))*fs,...
	   (xplus1 - xmin1)*fs*0.5,...
	   (x(end,:) - x(end-1,:))*fs);
