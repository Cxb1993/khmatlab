function qn = qnormalize(q)
  %% qq = qpropagate(q,w,dt)
  %% Propagates a quaternion assuming a fixed angular velocity w over the
  %% time interval dt 

  %% Kjartan Halvorsen
  %% 2011-03-20

  qq = q;

  for i=1:size(q,2)
    expw = qexp(w(:,i)*0.5*dt);
    qq(:,i) = qmult(q(:,i), expw);
  end

