  errangleB = zeros(length(TA),1);
  errangleA = zeros(length(TA),1);
  errangle = zeros(length(TA),1);
  qstart = [0;0;0;1];
  qAi = qstart;
  for i = 1:length(errangle)
    qAi = qmult(qAi, qexp(1/102.4*xB(1:3,i)));
    eqf = qmult(qAi, qstart);
    errangle(i) = 2*acos(eqf(4))*180/pi;
    eqf = qmult(qA(:,i), qstart);
    errangleA(i) = 2*acos(eqf(4))*180/pi;
    eqf = qmult(qB(:,i), qstart);
    errangleB(i) = 2*acos(eqf(4))*180/pi;
  end

  figure(8)
  clf
  plot(TA(1:end), errangle(1:end),'b')
  hold on
  plot(TA(1:end), errangleA(1:end),'m')
  plot(TB(1:end), errangleB(1:end), 'r')
